
/*
 * record.c
 *
 *  Created on: 11.01.2019
 *      Author: piotr
 */
//private defines
#define THRESHOLD 	100
#define CRY_THR 	10

#include "record.h"


static const float32_t base[19][65] =
{
		{15.5194,16.0291,13.2536,12.8950,15.4579,10.0736,11.5148,11.5535,13.4629,14.2590,11.1572,12.3465,12.8945,12.8730,10.5300,10.1777,11.5817,10.8636,12.3430,12.0444,12.2593,11.7767,11.3484,12.4669,12.6126,13.7759,13.3000,12.9076,11.4859,10.6558,12.3885,12.7835,12.8530,12.6919,13.5346,13.0331,12.6029,15.7118,12.2447,15.5737,14.9635,14.9612,13.6965,14.8138,12.5109,14.1611,12.7687,14.1052,15.2769,16.4341,16.1361,16.2136,16.2288,15.2257,15.2137,15.5785,14.6923,14.5921,15.1388,15.1678,17.7487,15.4442,14.8170,14.7344,11.1606},
		{-5.2356,-4.8733,-5.5428,-4.4432,-6.7770,-6.0946,-6.6859,-6.6259,-7.5534,-6.3091,-7.6956,-6.7338,-7.1699,-6.4331,-6.6144,-6.0485,-5.6131,-5.5593,-5.5353,-5.4326,-5.1073,-4.7818,-4.6732,-5.1673,-4.6583,-4.3475,-4.9187,-5.0421,-4.7174,-5.5061,-4.6470,-5.5963,-4.7000,-5.4320,-5.3438,-4.1697,-4.0002,-4.3053,-4.3365,-5.4993,-4.4735,-4.2286,-4.7989,-4.4561,-4.0504,-4.2277,-4.6987,-5.3314,-5.7291,-4.6774,-4.7805,-4.0131,-4.4300,-4.9455,-5.5278,-4.0518,-3.6408,-2.4751,-3.4101,-1.9166,-2.0627,-4.5005,-5.2432,-4.8521,-3.7811},
		{-7.6042,-7.6798,-6.6570,-5.0965,-6.7549,-5.5631,-6.3214,-6.0100,-7.2394,-5.6145,-5.9672,-5.6253,-6.3454,-6.8026,-6.8626,-6.3078,-6.2396,-6.2223,-8.1332,-7.6699,-7.0726,-6.2078,-6.2759,-7.7330,-9.0371,-9.9661,-9.0239,-7.2693,-6.3991,-7.2459,-6.4230,-7.7765,-7.1146,-6.8974,-8.3080,-7.2356,-6.9168,-7.3112,-6.4824,-7.9632,-7.7978,-7.6873,-7.9606,-7.1311,-6.0256,-5.9377,-6.3769,-7.7802,-8.9422,-9.2029,-9.8782,-9.9857,-9.6165,-8.6781,-9.7131,-8.4100,-7.2943,-6.4494,-8.1860,-6.5851,-6.5867,-7.4364,-7.8437,-7.5123,-0.4096},
		{2.7136,3.0428,1.5306,1.4966,2.8239,0.7635,0.5651,1.1368,0.9408,2.2741,1.4317,1.4291,1.9399,2.5182,0.9555,0.5202,0.8159,1.1747,2.0596,1.6184,1.7186,1.2113,1.7078,1.2693,2.1104,2.4773,1.9247,1.3103,0.7669,-0.0737,1.4606,2.8300,2.0219,1.2111,0.8067,0.8555,0.0214,1.6640,-0.0323,0.9309,1.5174,1.3138,1.7342,2.2942,0.4725,1.2228,1.1107,1.8916,1.6646,2.6812,1.7804,1.4345,1.3509,2.0053,0.9997,0.9281,-0.3406,-1.2069,-1.4143,-1.4758,0.4013,0.2391,0.4544,0.7066,0.4662},
		{1.4964,2.2560,1.1306,0.9412,0.0694,0.7894,0.1398,0.0928,-0.1171,1.0431,0.4904,0.0734,0.3545,0.6387,0.9242,0.6185,1.0308,1.3232,1.1787,1.4171,1.6944,1.5493,1.0177,1.5540,1.4912,2.9919,2.2317,1.3518,1.4484,0.2523,0.7951,1.6830,2.8721,1.8096,1.7332,2.2136,2.0806,2.3225,1.6615,1.3979,2.3732,1.8776,2.0857,2.3407,1.7562,2.4779,1.8450,1.8865,1.5045,1.3122,0.7524,0.8803,1.2835,1.9576,1.0599,0.9588,0.7412,0.3488,0.0845,0.8038,1.2059,0.8619,0.2214,1.2193,0.0179},
		{-2.0251,-2.7764,-1.9676,-1.8739,-1.1268,-0.1863,-1.0048,-1.8165,-3.7913,-3.7398,-2.7707,-2.8677,-4.7063,-5.5381,-4.0945,-3.9608,-3.3667,-3.4846,-5.9899,-5.0712,-3.9804,-3.7634,-4.3458,-4.3417,-4.4464,-4.8812,-4.0291,-3.1123,-2.4876,-3.2555,-2.4979,-2.7792,-1.3759,-2.1096,-2.8234,-2.0720,-1.2751,-1.8774,-1.6142,-2.5624,-1.5207,-1.5799,-1.7110,-2.0778,-0.9591,-0.8953,-1.5998,-2.4506,-3.9315,-3.8036,-4.7899,-4.2323,-3.2183,-3.3837,-3.5577,-3.0176,-2.1464,-1.2271,-2.6460,-1.0071,-1.7733,-2.2061,-3.0292,-2.3775,-0.4906},
		{-0.8183,-0.9704,-0.9160,-1.1295,0.7498,0.7042,0.8260,0.4982,-0.0205,0.4819,-0.1547,0.5736,1.0686,0.5988,-1.5463,-2.0048,-0.7318,-1.0998,-0.5541,-0.2207,-0.3005,-1.3474,-1.3834,-0.9408,-0.8660,1.2461,-0.2633,-0.6317,-0.5629,-0.4712,-0.0349,0.3568,-0.7733,-1.4639,-1.1461,-1.6089,-1.7634,-0.5274,-2.5222,0.1013,-0.4839,-0.1315,-0.5338,-0.4584,-1.4866,-1.1967,-1.7323,-0.6335,-0.2134,1.2959,1.3094,0.7939,0.3581,-0.3701,0.7288,0.4345,-0.8820,-0.4248,-0.1180,0.0274,0.6212,0.1186,0.1118,-0.4506,0.3971},
		{0.1239,-0.7007,-0.2713,0.1850,0.6973,1.4287,1.1897,1.1498,1.8139,1.5767,1.4190,1.2996,1.5046,1.0333,1.4112,1.2852,1.9861,1.9665,1.5182,2.0132,1.7212,2.0304,2.3277,1.6357,1.3258,1.8775,0.3012,1.4342,1.0899,1.3115,1.4453,-1.4977,-1.3858,-1.2353,-1.6778,-1.5632,-0.9163,-1.2220,-1.1512,-1.2587,-1.3900,-0.4577,-0.9632,-1.7741,-0.8335,-0.5422,-0.9596,-1.3433,-1.9198,-1.4709,-1.4182,-1.0747,-1.3686,-2.3583,-2.0065,-1.1353,-0.4912,-0.9358,-0.9930,-1.1930,-0.5383,-0.4800,-0.5042,0.1826,-0.1330},
		{0.3115,0.4238,0.5377,2.0362,1.3449,2.4040,1.9040,1.4006,-0.4022,0.8742,2.0511,1.0405,1.7870,2.1202,2.7240,2.6232,2.7929,3.1822,2.7726,3.5866,3.7456,3.8445,4.6974,3.6056,3.8140,1.9941,1.4935,1.7453,2.5535,1.5973,0.8282,1.0129,1.6319,0.7209,1.0394,1.2778,1.6594,1.5578,0.8819,1.4556,0.9952,0.9143,1.2933,1.1297,0.4384,1.1447,0.8198,0.9673,-0.2357,-0.3763,-1.1508,-0.0478,0.1140,0.7775,0.1397,-0.0925,0.3709,-0.3782,0.0512,-0.8662,0.3906,-0.0138,0.0726,0.1531,-0.2769},
		{0.2075,-0.0182,0.7125,2.4496,3.0252,4.0101,4.1157,4.0964,5.2482,4.3679,4.2165,3.7228,4.1906,3.2862,2.6351,2.3701,2.3681,2.7198,2.6145,3.1852,2.7999,3.0010,3.5092,2.0650,1.6052,2.8439,2.2532,1.3304,2.3327,1.4371,0.4789,1.1502,1.2955,1.4181,1.1657,1.5729,1.8420,1.8621,1.0376,0.8034,0.1063,0.2263,1.2614,1.3962,0.8500,1.2785,1.4144,1.6324,1.4038,0.3612,-0.2070,0.7510,1.7379,1.4022,0.4708,-0.4678,-1.0745,-0.7543,-0.8104,-0.8306,-0.8057,-1.1272,-1.0019,-0.6254,0.5180},
		{2.1929,3.3629,3.2140,2.2254,3.2444,1.9479,2.0267,1.9404,2.4967,2.7342,3.1981,2.8238,3.1546,2.6623,2.6069,2.3945,2.8407,2.8532,2.9496,2.9108,3.0585,2.6262,3.2774,3.0046,3.2495,3.5711,3.7041,3.6494,3.7308,3.7611,4.3001,4.7851,3.6357,3.1626,2.2910,2.4365,2.8329,2.3026,1.1701,2.0367,1.4857,1.7659,3.1515,3.0932,1.5628,1.7004,2.2501,2.8946,1.9422,1.0973,0.8388,0.8685,0.5430,1.8630,1.1899,-0.1391,-0.5225,-0.3738,-0.5327,-0.2393,-0.6870,-0.1247,0.3158,0.7357,-0.6254},
		{0.7069,1.7316,1.2598,-1.1565,-3.2706,-3.4013,-3.8704,-4.1934,-5.2518,-3.9752,-2.1593,-2.9023,-3.2796,-2.7987,-0.0957,-0.2742,0.7554,0.5011,-0.5564,-0.8451,-0.5527,-0.5346,-1.0212,0.2416,0.5233,1.4162,2.7615,2.5470,2.0619,3.1597,3.3236,2.6167,2.1957,2.3193,2.4943,2.6725,2.8104,2.3812,1.8065,1.5321,1.1628,1.4434,1.9983,1.9137,1.4468,1.8235,1.8091,2.0395,1.5400,0.1238,-0.4022,0.5942,1.5441,1.5782,0.8206,0.9765,1.3875,1.4113,1.6582,1.2261,1.2595,1.5720,1.3851,0.9949,0.5487},
		{2.1703,0.4257,-0.5076,-2.2776,-2.8924,-3.5531,-3.5160,-4.2631,-4.4786,-3.2347,-3.1763,-3.0377,-2.5165,-2.2775,-2.3269,-2.7202,-1.9790,-2.2466,-1.9108,-1.8777,-2.2576,-2.9134,-2.5400,-2.4348,-2.4626,-0.8346,-1.1666,-0.7069,-1.7325,-1.4466,-0.6894,0.9420,0.5949,0.3793,1.6293,1.0922,1.1114,1.9419,1.6657,3.1217,2.8101,2.7414,1.1934,1.0010,1.3219,1.7630,1.5996,1.5662,1.7771,3.0007,3.1453,3.5884,3.4153,2.4285,3.3764,3.5456,2.8268,3.1819,3.4326,2.6316,3.1530,2.6460,2.7369,1.4391,-0.3836},
		{-0.0983,-3.2549,-3.4886,-1.2124,-0.1898,0.4088,1.9402,0.6266,-0.1463,-1.4032,-0.4709,0.0376,-1.4706,-2.9057,-2.8109,-2.8465,-2.7763,-2.7804,-2.8341,-3.0910,-3.1615,-2.6509,-2.0555,-2.9596,-3.0112,-4.2296,-3.9537,-3.7555,-3.0177,-3.9329,-5.3158,-3.6092,-2.7587,-2.2922,-1.4989,-1.8612,-2.0719,-1.2451,-1.1407,-0.1313,-0.4465,0.2712,-1.0980,-1.2060,-1.0250,-0.9365,-1.1690,-1.1199,-1.1061,-0.2709,0.3659,0.3556,-0.6788,-1.6645,-0.4599,1.3935,1.3574,1.9083,1.1522,1.7770,0.8434,1.6740,1.9218,0.9463,0.2402},
		{-0.8644,-2.4738,-0.8836,1.0865,2.3888,2.0050,3.1798,3.0014,4.3029,3.4656,2.3118,2.9489,3.0973,1.6503,1.1364,0.9862,0.7892,0.9110,1.8764,2.2579,1.5062,1.7700,2.8892,1.3454,1.0958,-1.2438,-1.2787,-0.8477,-0.8269,-1.4359,-1.8108,-2.6358,-4.0080,-3.3180,-1.9255,-2.9488,-3.1133,-2.0508,-2.8449,-0.9492,-1.5078,-0.9713,-2.7224,-3.2514,-2.5678,-2.5955,-2.6415,-2.3776,-1.6371,-1.4030,-1.3247,-1.0883,-1.0372,-1.7143,-0.8767,-0.1134,0.2705,0.7232,0.4045,1.0970,-0.0207,0.2288,0.1214,0.2598,-0.1125},
		{-1.7004,-0.7624,0.0784,0.5200,-0.8607,-0.3214,0.4192,-0.4028,-1.7265,-1.2835,-0.2245,-0.3386,-0.4611,0.5351,1.1666,1.0217,1.1220,1.0977,1.3738,1.4477,0.9483,1.2568,2.0640,1.0989,1.1142,1.1192,0.2458,-0.5526,0.1216,0.1179,-0.2382,-0.6734,-1.7799,-1.7187,-1.8547,-1.9739,-1.4179,-2.3694,-1.9704,-1.7325,-1.9278,-1.4767,-1.6627,-1.9100,-2.0539,-2.1364,-2.2185,-2.6098,-2.7397,-1.9579,-1.4321,-1.1383,-1.4959,-2.7607,-1.4391,-1.2796,-1.3322,-1.2570,-0.8940,-1.4514,-1.5477,-1.2604,-1.4413,-0.9913,0.1002},
		{1.0317,0.9236,0.2909,-0.7064,-0.5041,-1.0780,-0.3429,-0.7189,-0.3337,-0.4624,-1.0565,-0.2905,-0.7891,-1.7501,-1.7281,-1.7092,-1.4115,-1.6512,-1.6112,-2.1243,-2.1399,-2.0158,-1.7256,-1.7707,-1.7554,-1.7110,-0.1726,0.1304,-0.7053,-0.0571,0.7248,1.4273,1.4565,1.2797,1.6545,1.6231,1.2473,1.9967,1.0877,1.3293,1.0027,0.7084,1.6269,1.8958,0.8404,1.0729,1.4401,2.0381,2.0742,0.3174,-0.3829,0.2220,0.9214,2.0394,0.8161,-0.5529,-0.8558,-0.8335,-0.8035,-1.5927,-0.9960,-1.0719,-0.5651,-0.1193,-0.0547},
		{0.6859,0.7461,-0.0709,-0.4716,-0.2707,-0.3654,0.3822,-0.4760,-1.6304,-1.3115,-0.6870,-0.3330,-1.1343,-1.5011,-1.1975,-1.2592,-0.9988,-1.1817,-0.9019,-1.4718,-1.4768,-1.7758,-1.8586,-1.4094,-1.4415,-1.7964,-0.7294,-0.4225,-0.5284,-0.6973,-0.8060,0.9289,1.0043,0.9793,0.4878,0.7572,0.8639,0.5226,0.7099,0.6058,0.2144,0.4250,1.0117,1.1628,0.5554,0.6002,0.9853,0.8403,0.5980,0.1503,-0.0653,0.4271,0.3294,0.7017,0.1635,0.1696,-0.2135,-0.2882,-0.0455,-0.4031,-0.2169,-0.1231,0.2026,0.3102,0.0920},
		{-0.6395,-0.1069,0.8538,0.4351,0.7156,0.1327,0.4041,0.0104,0.0920,-0.2321,-0.0516,0.1247,-0.4957,-0.4760,0.3181,0.0959,0.2844,0.2431,-0.0866,0.0898,0.1481,0.0885,-0.3194,0.4150,0.6461,1.6671,1.7100,1.0150,0.6127,0.4741,0.2654,-0.0969,-0.8782,-0.1943,0.3591,0.1395,-0.0254,0.0077,-0.0959,0.0303,-0.2331,-0.0063,-0.7166,-0.6893,-0.4104,-0.2952,-0.0094,-0.1917,-0.1547,-0.0343,0.4163,0.2953,0.0579,0.0639,-0.0074,0.4980,1.1968,1.1170,1.2919,1.5793,1.0301,1.0277,0.9505,0.4067,-0.0474}

};

static const float32_t base2[19][65] =
{
		{12.7351,12.6540,12.2856,10.8437,10.6656,9.4282,10.7141,10.2667,10.8206,10.6974,10.8727,10.6787,9.9045,8.8330,10.8271,9.8762,10.3295,9.0551,9.1978,9.3458,9.9456,9.7654,10.8644,10.9449,11.0927,9.3237,9.1235,9.7531,9.7206,8.7807,8.6957,8.1880,6.8873,7.5726,7.4474,5.5236,6.4751,4.3984,4.8379,6.0192,5.0688,6.6537,6.3316,5.2578,6.5728,7.0999,5.1395,7.2218,6.2626,8.4936,8.3642,8.5020,9.9229,10.7396,11.6414,11.7117,12.5496,11.7831,12.7365,12.3260,12.8910,12.4547,13.4374,13.0406,6.8136},
		{-4.2672,-4.9496,-5.0382,-5.4331,-6.3958,-9.2973,-8.1706,-7.4275,-8.3162,-8.0406,-7.3381,-6.0267,-6.3476,-5.9932,-5.3670,-6.1124,-5.8248,-5.1860,-4.9268,-5.7532,-5.6353,-4.4844,-3.4137,-3.6632,-3.5567,-4.4769,-5.7075,-5.8427,-5.3580,-6.8893,-8.4624,-8.4318,-7.6467,-7.6924,-7.1705,-8.1401,-7.2161,-7.6596,-7.2874,-6.7205,-6.8430,-5.6772,-5.8618,-7.5519,-7.7381,-8.7560,-9.1329,-8.3022,-9.5032,-7.3783,-7.8105,-9.0757,-8.5908,-8.6120,-7.0694,-7.3004,-6.6690,-7.5551,-5.8383,-5.2144,-5.3842,-5.8340,-5.1026,-6.6280,-1.6378},
		{-4.7891,-5.2644,-5.1327,-5.0175,-5.7587,-5.6657,-4.5954,-4.7788,-4.6000,-4.5275,-5.0650,-3.7462,-4.6328,-5.0414,-4.4672,-3.6835,-3.7046,-4.4989,-4.2570,-5.7215,-6.0544,-5.4093,-6.2762,-5.1911,-5.9021,-5.4290,-6.8998,-4.1370,-4.9517,-5.5129,-7.3085,-7.4924,-6.5466,-6.9853,-6.4322,-7.9747,-7.5258,-7.4445,-6.6924,-9.0598,-6.5466,-6.1404,-6.6183,-6.5954,-8.3442,-7.5322,-8.0189,-6.6832,-7.6576,-7.1786,-8.2472,-8.4274,-8.4211,-7.8144,-6.3558,-6.2073,-7.6111,-6.6729,-5.2189,-5.4233,-6.2523,-5.6878,-5.2754,-5.2750,-0.7585},
		{0.4575,0.2419,-0.4245,-0.2777,-0.5792,-1.4645,-0.6710,0.1752,-0.4627,-0.4596,0.0012,0.5614,0.3279,0.1606,1.2288,0.7413,1.4939,0.7732,1.0725,1.2458,0.1724,-0.2602,-0.3319,0.9589,0.3468,0.0582,0.1294,1.4309,0.2479,-0.7298,-2.0024,-1.3088,-0.8560,-0.2670,0.1490,-1.1060,-0.4267,-0.5540,0.5427,0.0689,-1.5831,-2.6503,-2.3836,-1.2589,0.4446,0.2265,-0.6298,0.0784,-1.0091,-0.4832,0.8206,0.0862,1.3836,1.4035,1.3849,1.1859,0.8817,1.1712,1.9383,0.6783,1.0334,1.4380,1.5212,2.2091,0.3564},
		{3.7080,3.3430,2.6808,3.8342,3.7856,2.6336,3.4095,3.3710,3.0189,2.9992,3.5133,3.5890,3.5623,3.9620,4.2313,3.3846,4.1623,3.9250,3.6300,4.7188,4.2347,2.5576,3.1211,3.8615,3.3644,3.3880,3.7939,4.1354,4.0645,3.1727,1.4564,2.9808,1.9898,3.5761,3.9893,2.5299,0.9294,-0.1770,-0.9159,0.6290,0.0820,0.5262,0.4377,-0.8054,-0.0261,1.5693,0.6394,-0.1362,-0.9461,-0.3005,-0.0288,-0.1705,1.0015,0.3711,1.3123,0.2725,0.8769,0.7071,1.8680,1.1108,1.6001,1.4464,1.6144,2.8636,-0.1489},
		{-1.7877,-2.1946,-2.0810,-1.2836,-2.2327,-3.5703,-3.0846,-2.9409,-2.7685,-2.7154,-2.6169,-3.0631,-2.8371,-2.7746,-3.3555,-2.9745,-2.8658,-3.0503,-3.2271,-2.7467,-2.2457,-3.0306,-3.1062,-2.4418,-3.1075,-2.8655,-3.5277,-3.1480,-3.4049,-2.5157,-2.7063,-2.7691,-1.5368,-2.7523,-4.4274,-4.1232,-4.8497,-3.7337,-2.7545,-2.5698,-2.2981,-2.3968,-2.5133,-2.3602,-2.8146,-3.7919,-3.7831,-4.6625,-5.0588,-5.2084,-5.1366,-4.6306,-4.5170,-4.6394,-3.2782,-3.6111,-4.4595,-4.2211,-3.8324,-3.4853,-4.0714,-4.1430,-3.8969,-3.4349,-0.0218},
		{0.8980,0.1208,0.4500,-0.6415,-0.5368,-0.2922,0.1158,0.1169,-0.4849,-0.3037,0.1275,0.3703,-0.0514,0.0275,0.7563,0.1838,0.0459,1.0906,0.5516,0.2007,0.0112,0.1808,-0.2552,-0.1850,-0.0384,0.2524,-0.1869,0.6667,1.6649,1.0889,1.1262,1.5392,2.1710,2.4063,2.1699,1.4538,2.4871,1.4754,0.5885,1.3678,1.6497,2.5248,2.6839,1.8662,1.7385,2.7607,1.9830,1.0554,1.1272,0.9668,1.2216,0.9039,0.5184,0.3716,0.1494,0.0093,-0.5436,-0.4162,-0.0357,-0.7318,-0.4773,-0.1551,0.8095,0.6068,-0.0622},
		{-0.3471,-0.3675,-0.6037,-1.2319,-1.4937,0.2604,-0.1632,0.2090,0.3466,0.1105,0.3660,0.8507,0.4491,-0.2363,0.6752,1.4732,0.2052,-0.3398,0.4662,-0.3696,-1.0478,-0.7956,0.0938,-0.5704,-0.4636,-1.4291,-1.2930,0.7163,-0.4375,0.8856,1.6152,2.5684,2.4184,3.8599,4.5973,4.2301,3.4580,3.5036,3.5895,4.1233,4.6074,3.9703,3.6406,4.7640,4.2148,3.0395,2.7692,2.1823,3.1133,1.2923,0.6526,0.4852,0.3537,-0.1220,0.4145,-0.4047,-0.2742,-0.6215,0.5080,0.2052,-0.3503,-0.1537,0.6740,0.7797,0.0276},
		{-1.0290,-1.0048,-2.0472,-2.6617,-1.7140,-1.6760,-1.5123,-1.3322,-1.1514,-1.6304,-1.0488,-0.6656,-0.1919,-0.1954,-1.1786,-0.7102,-0.8343,-1.0285,-1.1527,0.2101,-1.7788,-1.4252,-0.6879,-0.2367,-0.6479,-1.7464,-0.6564,-0.6723,-0.2201,0.9653,1.2882,1.5438,2.0909,3.2330,4.2889,3.2740,3.6705,4.6331,5.3431,3.8779,4.3881,4.0972,4.3130,4.6834,5.8981,4.9769,4.2906,3.1825,3.4691,2.3082,1.9288,0.3776,-0.0370,0.1710,-1.3429,-0.6148,-0.7779,-2.3687,-1.8646,-0.8273,-1.3801,-1.4827,-1.2967,-1.3710,-0.0474},
		{1.5918,0.8533,1.4981,1.5136,1.2984,1.2690,1.9065,2.0506,2.2186,1.9976,1.1478,1.0385,0.6880,-0.0095,0.3955,1.0607,2.1072,1.9611,1.0924,0.7326,0.9385,0.7005,0.4709,1.0685,0.9371,0.3395,0.7348,1.6064,2.5215,3.8404,4.8293,3.6825,3.8280,1.6434,1.6127,1.5475,1.1184,1.1059,0.7119,3.4556,1.3332,1.0585,1.5278,1.6646,1.3885,1.3446,3.3705,3.7874,5.1587,2.9503,2.4714,1.4258,1.3547,0.2570,-0.5882,-0.1663,-0.3223,-0.8489,-0.9530,-0.9393,-0.8860,-1.6880,-1.0662,-0.0879,-0.0022},
		{-0.5111,-1.0276,-0.2992,-0.0087,-0.6389,-0.7540,0.4171,0.5306,0.0517,0.3230,-0.4517,-0.7461,-0.6017,-0.7735,-0.3995,-0.6827,0.3884,1.9786,0.4662,-0.4429,-0.0462,-0.0035,-0.5904,-0.8687,-0.6534,0.1127,-0.4511,0.5559,2.7638,2.6920,2.5347,0.6536,0.6946,-1.1539,-1.2135,-0.9441,-1.9696,-3.2778,-4.5517,-6.0405,-5.4490,-6.0692,-6.1944,-6.3728,-4.6978,-2.1603,0.1665,0.5746,2.5992,2.3361,1.9138,1.8892,1.4151,0.0906,0.9356,0.3266,-0.7321,-1.0555,-0.9919,-0.8903,-1.1300,-1.4967,-0.9465,-0.5242,-0.0030},
		{-1.4247,-1.1172,-0.6886,-0.0695,0.3880,0.4634,1.4355,1.3571,1.6474,1.2842,0.6134,0.2826,0.5125,0.5915,-0.5923,0.8811,0.7005,1.4907,0.1987,0.6607,-0.2825,-0.8302,-0.6329,-1.5912,-1.0548,-0.3311,-0.0055,0.4352,1.5386,1.3625,-2.1421,-4.0819,-4.1715,-4.8017,-6.6938,-5.8868,-6.2774,-5.7121,-5.6545,-6.1616,-3.9312,-3.6336,-4.1793,-5.0528,-5.7362,-5.8018,-4.4586,-4.0518,-3.4204,-1.0098,0.4949,1.2999,0.6105,0.0353,0.6393,0.1318,-1.1052,-1.8567,-1.2352,-0.6928,-1.5297,-1.4549,-1.1593,-1.5577,-0.0054},
		{0.2745,0.5371,0.6266,1.4561,1.5261,2.3947,1.7588,1.6774,2.4571,2.0073,3.2860,3.3570,3.9100,2.8071,2.9198,3.2682,2.1011,1.5648,2.2085,2.6862,1.5784,0.5313,0.9331,0.0257,1.0678,1.3734,2.4169,2.2680,0.4697,-0.5533,-1.9901,-3.4890,-3.9768,-1.5285,-0.9337,-0.2554,0.4250,0.2656,0.5737,2.6728,1.5555,2.1930,2.3138,1.9718,0.6497,-1.6520,-3.2944,-3.8322,-3.2505,-1.2863,-1.0706,-0.0658,1.8561,2.5114,1.3138,2.0623,0.7709,-0.4456,-0.0458,-0.4488,-0.1814,0.0906,0.6641,0.0422,0.0129},
		{0.1963,0.5018,0.5100,2.4529,1.7282,0.3729,-0.3328,-0.4419,-0.2044,-0.4995,0.5156,0.9216,1.5721,2.1445,1.3266,1.1916,-0.4177,-0.7094,0.0747,1.9639,1.5260,1.0725,0.7010,0.5016,0.7925,1.9898,1.2948,0.0861,-1.0160,-2.4886,0.3976,1.0624,1.1759,0.6523,1.3530,1.2227,0.5776,0.8026,1.2874,-0.2634,0.9237,1.1063,1.0689,0.8701,1.1686,0.7277,1.1990,0.9169,0.1619,-1.6724,-1.9961,-2.4669,0.7171,1.2784,1.5718,1.4552,0.2227,-0.4838,-0.5289,-0.8167,-0.5532,-0.3405,-0.0065,-0.1777,0.0023},
		{0.1035,0.2741,1.0928,2.2220,1.1573,-1.4071,-1.6373,-1.8156,-1.2484,-1.7383,-1.5003,-1.5741,-1.2020,-0.6358,-2.1736,-1.0775,-2.0956,-1.4463,-1.4489,-0.0246,1.4456,1.0327,0.4815,0.4584,0.6811,1.2864,0.0212,-1.5166,-2.8135,-1.7014,1.7335,1.0036,1.7851,0.2658,1.5009,0.8196,1.0413,1.1266,1.0451,0.3474,0.1321,-1.2393,-1.2058,-0.1689,0.3930,1.7339,2.6061,2.4361,2.4314,0.5573,-0.6936,-1.3218,-0.8384,0.1270,1.7302,1.3549,0.8836,-0.0571,-0.2449,-0.5804,-0.6381,-0.2351,-0.3595,-0.0096,0.0214},
		{0.2671,0.5626,0.7681,-0.8408,-0.4635,-1.8689,-2.1807,-2.5710,-2.3128,-2.2419,-1.4648,-1.5069,-0.8061,-0.5331,-0.7253,-1.7006,-2.3265,-2.5763,-2.5042,-0.6736,-0.9844,0.3430,0.4516,-0.2388,0.5838,-0.1766,-0.5242,-2.2828,-1.8381,-0.2574,-0.7953,-0.9627,-0.7979,-0.3354,0.5528,0.0594,-0.0251,0.0841,0.4034,0.5062,0.3910,-0.1233,0.1753,-0.3065,0.1903,-0.0389,-0.0694,0.5277,-0.0588,0.0961,-0.1423,-0.6559,-1.5577,-0.6321,0.0107,1.0474,0.7233,0.0863,0.1114,-0.2839,-0.2840,-0.8285,-0.5989,-0.3248,0.0071},
		{0.9723,1.2507,0.6970,-0.7860,-1.0151,-0.0785,0.8928,0.7797,1.1039,0.7766,-0.1009,-0.4317,-0.4571,-1.3667,-1.3907,-0.5529,0.4785,1.2749,0.4410,-0.3628,-0.8935,0.4778,1.9288,1.3052,1.2196,-0.3179,-0.8900,0.2978,1.2108,-0.3150,-0.3932,0.5335,0.0997,1.3351,2.3224,1.8002,1.6456,1.7357,2.2280,2.4991,1.5217,1.3687,1.4687,1.8635,2.2400,2.0778,0.9483,0.3523,-0.9020,-0.8729,-0.7931,0.1905,1.0106,-0.0267,0.1393,1.4219,1.1985,1.6126,1.5044,1.0507,1.2628,0.5337,0.6692,0.1594,0.0338},
		{0.3428,0.4751,-1.2906,-1.5393,-1.2239,-1.0564,-0.1535,-0.2070,-0.4060,-0.4133,-1.0226,-0.8380,-0.8212,-0.9903,-1.4538,-0.5983,-0.2975,0.2678,-0.4195,-1.0872,-1.3016,-1.0277,-0.7807,0.5563,-0.6480,-1.4525,-1.4187,-0.4889,0.3803,-1.0778,-0.6308,-0.7548,-0.3992,0.4170,0.6848,0.8740,0.6294,0.8293,0.6891,0.3230,0.9278,1.0065,1.0047,0.9602,0.8272,0.5671,-0.3673,-1.0220,-2.0002,-1.2217,-1.4033,-0.9081,0.4940,0.2677,-0.4316,-0.8720,0.2086,0.8084,0.7013,0.5275,0.3795,0.1360,0.2386,-0.8460,0.0095},
		{1.0349,0.9580,-0.3518,-0.2502,0.5604,0.8667,0.1003,0.1550,0.6141,0.4914,1.1389,1.4556,1.3520,1.1667,1.9013,1.3862,0.8891,0.1154,0.6697,0.6608,0.4414,-0.2303,0.6754,1.1077,0.3942,-0.2965,1.1962,0.8266,-0.4532,0.9904,0.8050,0.0175,0.2916,-0.6535,-1.8553,-1.5263,-1.2711,-1.1697,-0.7063,-1.2155,-0.5169,-0.4619,-0.7469,-0.4565,-1.3040,-1.7594,-1.4235,-1.4998,-1.4369,0.1015,0.5912,-0.1865,0.0752,1.1703,-0.4859,-1.0969,0.6273,1.0197,0.8050,0.3105,-0.0124,0.5298,0.6580,0.3650,0.0048}
};

static const float32_t base3[19][65] =
{
		{15.5399,13.1642,14.4401,13.1521,12.7782,14.2034,15.2460,14.0479,16.3106,15.9997,14.3113,14.2988,14.0777,15.3316,15.6459,14.3997,16.6649,15.1588,16.2133,17.0033,15.4014,16.5413,16.1841,16.0321,13.5750,12.6815,13.4594,12.8779,12.0179,12.4399,10.4905,11.2082,10.6615,9.7948,9.2923,8.5935,8.0796,9.0972,10.8082,9.6655,9.9245,8.5132,10.5258,9.8234,11.0574,10.2967,10.1702,10.2684,11.8795,10.9348,12.7792,11.4083,12.3314,11.3222,12.3285,11.7727,11.9082,12.0929,12.0969,10.9646,11.2411,12.3773,11.8870,12.3553,12.9275},
		{-4.3324,-6.0923,-7.2314,-5.1073,-7.3011,-7.7186,-6.1898,-6.1274,-5.8145,-5.6687,-5.2381,-4.8873,-4.6051,-4.3742,-3.2646,-2.9839,-1.5262,-2.2117,-2.3581,-2.1044,-1.0122,-1.7523,0.0165,0.5903,-0.8109,-1.6091,-1.8325,-1.9437,-2.5847,-1.3895,-0.6968,-1.8829,-1.9499,-1.5937,-2.9041,-4.0064,-3.6386,-4.0697,-3.9782,-4.8616,-4.8597,-5.0367,-4.4633,-4.7133,-4.6011,-3.3852,-5.0800,-3.7905,-3.9848,-3.8944,-3.4352,-3.8207,-2.0002,-1.8930,-2.3200,-3.6716,-4.4546,-4.0609,-3.0984,-2.9400,-2.9809,-3.0244,-1.7477,-2.7127,-3.5510},
		{-7.3444,-6.7238,-6.8482,-5.9611,-6.0827,-6.3384,-7.0653,-7.9886,-7.6506,-8.4099,-6.9403,-6.8468,-7.4582,-8.2549,-6.7319,-6.7682,-6.3312,-6.1980,-4.7643,-4.5959,-4.8662,-5.4774,-3.4856,-2.9393,-2.6308,-2.9056,-2.3098,-0.5292,-2.1247,-2.3851,-3.3119,-3.6760,-3.1292,-4.0426,-4.2452,-3.5719,-3.2528,-3.3084,-3.8738,-5.2854,-4.3000,-4.5931,-4.2532,-5.8810,-3.7203,-3.9771,-4.3159,-3.7781,-3.4371,-2.9069,-4.5009,-4.4214,-4.5821,-3.7140,-3.4589,-4.5412,-5.3326,-5.1173,-5.5396,-4.4377,-4.4551,-5.4944,-5.0548,-4.0720,-4.9378},
		{-1.6989,-0.8580,0.0790,-1.3379,-0.4858,-0.7954,-0.1105,-1.9491,-0.6448,0.7603,1.1137,1.3643,1.9785,3.5681,2.6931,3.8187,4.0997,3.6306,3.1714,4.3697,3.0817,3.5076,3.7461,2.7976,3.4335,3.2652,3.9718,4.1909,3.2998,1.4136,1.6263,1.5334,1.4884,1.8847,1.4879,1.7294,2.2661,2.3229,1.6810,1.3621,0.0080,-0.7702,-0.1311,-0.2474,0.4999,0.8368,-0.0403,-0.4241,0.2954,1.4098,2.3795,1.5883,1.9568,0.0889,-0.1134,1.1403,1.1000,0.7281,1.4249,1.1925,2.3968,1.0850,-0.7542,2.1556,2.3417},
		{0.4724,-0.1707,-1.5341,-0.1730,0.5356,-0.2618,0.1635,-0.6743,-1.5751,-1.5711,-1.4340,-0.6970,0.3322,-0.2626,-0.8094,-2.1303,-0.9328,-1.4895,-1.2676,-1.7315,-1.0063,-0.9121,-0.8074,-1.4273,-1.3445,0.1090,-1.4558,-0.7176,-1.6217,-2.2548,-2.0029,-2.1035,-1.4320,-1.0596,-0.1343,-0.5968,0.6278,0.5345,0.4425,-0.2216,-0.2617,-2.0283,-1.6186,-0.4522,-1.7010,-0.4286,-0.9992,-2.1612,-2.9035,-2.4735,-2.1354,-1.0033,-1.1034,-2.3776,-1.8007,-1.1000,-0.6350,-2.2027,-3.2745,-3.1359,-2.8944,-4.2928,-4.4993,-1.2909,-1.8917},
		{-2.3153,-1.5749,-1.5565,-0.9978,-2.4522,-3.0480,-2.9039,-2.5521,-2.7436,-3.4463,-3.1062,-3.2869,-1.6284,-1.9925,-1.2858,-1.9136,-3.2330,-0.9723,-3.3175,-2.9082,-3.0711,-4.1674,-2.3448,-2.7837,-2.9005,-2.4998,-2.6140,-1.0816,-1.8428,-3.0692,-2.9451,-4.0585,-2.6526,-3.5220,-2.7378,-3.0844,-3.4633,-1.6997,-2.7853,-3.4903,-3.8442,-3.9930,-3.7423,-3.0975,-3.4114,-3.5253,-4.7343,-2.6107,-4.2325,-2.5907,-3.8913,-3.2316,-3.7433,-4.2962,-3.4204,-2.6741,-3.2567,-1.6670,-3.5643,-2.5191,-3.0977,-3.6938,-3.3817,-1.7529,-2.9440},
		{0.3387,-0.2014,0.3786,1.1566,0.5268,0.9403,-0.2634,0.5692,1.2539,-0.6650,1.2234,0.1159,0.3331,0.4760,0.8490,0.7622,-0.2628,0.8524,-0.4490,1.3920,0.8720,0.5877,1.3717,0.2463,1.7179,1.9276,2.6937,2.7115,4.0271,4.5200,2.5813,3.6493,3.1062,3.4186,2.7777,3.3539,2.4355,2.2197,0.7874,2.5593,1.1941,1.0338,1.9819,1.0843,1.5437,1.8515,0.8022,1.1791,1.9379,2.0585,2.1837,1.4127,0.1537,0.5577,1.2020,2.2299,2.6949,1.6412,1.1052,1.2844,1.9632,1.8710,0.2919,1.0030,0.9751},
		{2.8714,2.0390,2.9619,1.2533,1.9600,1.2367,2.0418,2.5636,2.6962,1.7226,2.1007,1.0446,0.6737,-1.8163,-0.8438,-1.5718,-0.6719,-0.9277,-0.5512,-0.8733,-0.2796,0.1561,-0.7035,-0.5631,0.3852,0.8479,0.2077,1.3566,1.4607,1.4711,2.4576,2.8269,1.4533,1.7468,1.2176,0.7542,-0.0423,-0.3364,-1.2234,1.0820,-0.6117,-0.8598,0.3021,-0.6683,-0.3339,-1.7223,-0.6099,0.2281,-1.1827,-1.1890,-1.2502,-1.8683,-0.7889,-1.0119,-0.8068,-1.5703,-0.1798,-1.6148,-2.0888,-0.9529,-1.5312,-2.5958,-1.8405,-1.1675,-1.4925},
		{2.9182,2.5949,2.4927,1.9383,1.5114,1.2292,2.5877,2.0555,1.4919,1.8748,1.7491,0.9576,0.5961,-0.2337,-0.3709,-0.5523,-0.1658,-0.6602,0.1784,-0.4596,-0.7148,-0.9870,-0.0615,-1.2854,0.5051,1.5439,0.0697,0.7929,0.6855,0.9016,1.7230,1.0713,2.1310,0.0374,0.5007,-0.1407,-1.0664,-0.7980,-1.0389,0.3656,-0.6357,0.3392,-0.1130,-0.5204,-0.7508,-1.7475,-0.9701,-0.4326,-1.7712,-1.6743,-1.7247,-1.7941,-0.7808,-0.6936,-0.9356,-1.5963,-1.4143,-0.6708,0.1518,-1.2598,-0.7460,-1.3364,-1.3678,-1.7932,-1.8490},
		{0.9725,1.2506,0.1145,0.1369,0.3710,0.0081,0.0688,-0.1883,0.6119,1.2263,1.5027,-0.4150,-0.1572,-0.0021,0.0019,-0.3696,0.4654,-1.0107,-1.0240,1.2264,0.6583,-0.5022,1.1132,-0.1701,1.3089,1.1435,0.9854,0.4300,0.5304,1.5532,1.9153,2.5071,1.6137,1.1475,1.7363,2.4617,1.2591,1.0206,0.8396,2.0237,2.1034,1.1517,1.1817,1.7317,1.4263,0.0293,1.1108,1.6830,1.1196,0.6644,0.3331,0.0137,0.5229,0.9634,2.1373,0.6148,0.4505,1.4193,1.7892,0.8940,2.2642,3.3050,1.9786,-0.2962,1.3459},
		{-2.2347,-2.3346,-2.3800,-3.1214,-2.8183,-1.6460,-2.2941,-2.6483,-0.6428,0.0717,0.7660,0.0388,1.0412,0.6672,0.4995,1.5494,1.3819,0.6708,1.2195,1.1704,0.7554,0.5648,0.4940,-0.1725,0.1460,0.3911,0.6102,-0.1331,-0.1656,0.4278,1.2649,0.0146,-0.7066,-0.7537,-0.4750,0.0743,-0.6014,-0.9516,-1.4920,-1.7241,-1.9582,-1.1092,-0.7659,-0.9079,-1.2326,-1.5826,-1.4731,-1.0203,-0.7776,-0.5337,-1.2038,-1.4217,-0.3831,0.0525,-0.0766,-0.3775,-0.7794,0.1761,1.3485,1.2268,3.7105,1.9470,1.6355,0.0345,1.6512},
		{-2.7118,-2.3000,-2.4856,-2.4470,-1.5390,-1.9159,-2.2086,-2.6831,-2.2941,-2.0527,-1.9848,-1.5573,-0.8536,-1.4810,-1.4172,-0.4450,-1.0038,-1.6948,-0.4831,-0.3422,0.3099,0.6286,-0.1936,0.3690,0.5016,0.9729,0.2858,-0.4188,-0.2817,-0.3834,-0.9838,-1.5732,-1.2530,-0.2250,0.1155,-0.1699,0.5900,-0.8838,-0.3750,-0.2065,-0.8906,-1.4598,-1.0151,-1.3392,-0.8339,-0.8824,-1.4519,-0.8997,-0.9949,-0.7096,-0.7279,-1.2294,-0.5748,-0.1178,-0.4363,-0.6864,-0.7502,-0.4626,-0.1984,0.0326,0.8616,1.0639,0.7305,-0.1883,0.2415},
		{-0.3565,0.6684,0.9100,1.0889,1.4228,0.4084,0.4072,-0.2981,0.3380,0.0671,-0.9080,0.0250,-0.5132,-0.0219,-0.1360,1.0216,0.3808,-0.3680,0.8320,0.8978,0.9483,0.8681,0.4353,1.4972,1.2533,1.3332,0.5170,1.1950,1.0390,-0.4978,-0.5276,0.2792,0.4687,0.0270,0.4524,-0.1813,0.2270,0.5609,-0.0672,0.0071,-0.5107,-0.1018,-0.5241,-0.8429,-0.0630,-0.2935,-0.4185,-0.2948,-0.2938,0.2878,-0.2483,0.3315,-0.3689,-0.2367,-0.3785,-0.0766,-0.5280,-0.3040,0.2228,-0.3893,-0.2688,0.4262,1.3478,1.6268,0.6414},
		{0.2632,-0.0172,0.1980,0.3297,0.3736,-0.1250,-0.5090,-0.3352,0.0288,-0.5978,-0.9744,-0.2311,-1.9751,-2.6275,-0.9618,-1.1053,-0.9516,-0.8620,-0.6925,-0.5521,-0.2676,-0.7266,-1.5046,-0.7455,-1.1157,-1.8458,-1.1552,-0.6282,-0.5450,-1.4620,-1.9020,-1.7665,-1.7494,-1.1830,-1.8308,-1.5982,-1.1761,-1.2838,-1.7655,-1.4515,-1.7664,-1.0339,-1.2638,-2.1122,-1.4387,-1.7088,-0.9734,-1.9561,-1.7196,-1.3012,-1.6181,-1.1208,-1.5609,-1.9698,-1.6820,-1.4908,-1.9538,-1.3278,-1.6483,-1.1117,-1.2006,-1.2059,0.3704,1.1677,0.6590},
		{0.4460,-0.0989,-0.1222,0.1056,0.3472,0.8109,0.5929,-0.2566,0.4930,0.9128,0.3650,0.7822,0.1357,0.4846,-0.1400,-0.3369,-0.3607,0.0763,0.5781,0.3831,0.6719,1.2018,-0.0267,0.0305,-0.5465,-0.7710,-0.1513,-0.6140,0.6277,0.6557,0.8431,1.5764,0.5787,1.0235,0.6928,1.5397,0.8376,-0.1473,0.6934,1.0342,0.7807,0.9810,0.8357,0.3889,0.8415,0.4981,0.8814,0.0068,0.3099,-0.1140,0.2683,-0.2545,-0.2385,-1.0427,-0.3438,0.0781,0.4256,0.2053,0.3846,-0.1605,0.0752,0.7199,0.7560,0.6808,0.6246},
		{0.1951,0.2572,-0.0201,1.2943,0.7939,0.6574,0.3127,-0.0582,-0.2044,-0.0949,-0.0763,0.0608,0.5471,0.1875,0.4004,0.5598,-0.3959,0.0636,0.0766,0.1239,0.0051,-0.0401,-0.3715,-0.3006,-0.1940,-0.7087,0.0309,-0.3436,-0.0875,-0.0716,0.0089,0.2846,0.4840,0.1114,0.0677,0.3320,0.6719,0.3505,0.8081,0.3257,-0.5835,-0.5493,-0.4422,-0.5232,0.8038,0.6070,-0.0744,-0.2855,0.0334,0.0862,-0.0044,0.1740,0.2458,-0.0097,0.2367,0.5005,0.1368,0.0817,-0.7300,-0.6258,-1.6741,-1.6856,-0.6798,-0.7625,-0.5794},
		{0.7555,0.6352,0.9040,1.9038,0.8614,1.5033,1.0459,1.2318,1.2447,0.2072,-0.4799,0.1974,-0.2499,-0.1119,0.4063,-0.0576,0.5732,0.2642,0.3150,0.5425,0.6791,0.3858,1.1149,0.3199,0.8376,0.8731,0.8157,0.5211,0.9052,0.3535,-0.2038,0.5780,1.2079,1.4945,0.9315,0.8245,-0.1836,-0.3981,0.0678,1.0965,1.3665,0.6663,0.9534,0.3335,0.9154,1.1625,1.1309,1.2361,1.1145,0.4800,-0.1245,0.5045,0.9050,0.9204,0.7214,1.1932,1.3491,0.7888,0.0466,0.4775,1.1536,0.0904,0.6924,0.3389,0.8778},
		{0.1661,-0.3470,-1.3583,-0.2480,-0.3344,-0.5235,-0.0041,0.4423,-0.7018,-1.1984,-1.0769,-0.1474,-0.5035,0.7818,-0.0858,-0.4277,-0.1226,0.1192,-0.5236,-0.4274,-0.6062,-0.3045,-0.4055,-0.7965,-0.5067,-0.1682,-0.8325,-0.8328,-0.0280,-0.3894,-0.3168,-0.2763,-0.2766,0.5942,0.1889,0.1444,-0.5279,-0.9619,-0.7594,-0.2226,-0.0707,-0.1155,-0.2852,-0.3384,-0.2282,-0.2289,-0.5059,-0.2936,-0.0568,-0.2130,0.5645,0.0356,-0.3143,-0.4670,-0.8114,-0.6165,-0.0757,-0.4106,-0.6089,-0.8469,0.0512,0.9515,0.1957,-0.5135,-0.1276},
		{-0.5825,-0.4823,0.4593,-0.3254,0.4032,0.0432,-0.2312,-0.1818,-0.0528,0.4296,-0.4578,-0.4680,0.5168,0.2127,-0.0934,-0.4655,-0.2088,0.2871,-0.4789,0.4000,0.0999,0.5191,0.4596,0.0667,0.3376,0.1202,0.4760,0.3410,0.3461,-0.1192,-0.1900,-0.5203,-0.2828,0.0274,0.3153,0.3970,0.5757,0.3344,0.5969,-0.2818,-0.2501,-0.0036,-0.4364,0.1165,0.3598,0.3541,0.1558,-0.0353,0.1058,0.4409,0.7605,0.5924,0.3771,0.2365,0.6951,0.2286,-0.2254,0.2149,-0.2320,0.3539,-0.1128,0.1969,0.8875,-0.2560,-0.4462}

};

static const float32_t base4[19][65] =
{
		{13.0537,14.2877,13.9510,12.4052,13.1059,16.3229,14.1931,14.8765,16.1324,13.9140,11.9422,12.9517,14.0014,13.5385,15.8070,14.1725,13.4058,13.7326,13.5606,12.9953,12.6763,11.4915,13.6473,13.3200,13.9957,11.8406,15.2788,13.5674,14.2287,15.9125,16.9531,17.2840,16.3821,16.7907,13.9164,16.9368,17.8147,18.7331,17.6225,15.1995,16.6258,16.7213,14.6710,13.6947,12.4028,15.0171,15.9871,15.9178,17.0840,13.8532,14.3164,13.9150,12.7312,14.2818,15.1434,11.8311,12.3290,11.7641,14.1211,14.0039,15.1633,13.4954,14.0585,12.7774,14.3720},
		{-3.4913,-7.5964,-8.3252,-8.2576,-8.6888,-7.0295,-5.8596,-6.3709,-6.8787,-7.5745,-6.5998,-5.3700,-4.5173,-5.6500,-5.4934,-5.3942,-5.5984,-5.6909,-5.8102,-6.2564,-5.7116,-6.0544,-5.8995,-6.3512,-6.0717,-6.7127,-5.0289,-4.2497,-5.5613,-3.3008,-3.2595,-2.2074,-1.7422,-1.3040,-1.0889,-2.1574,-1.8896,-1.2196,-1.8420,-2.4583,-3.8791,-7.5881,-8.0625,-8.0769,-8.6683,-7.0233,-7.0767,-7.4917,-6.1528,-7.0614,-7.7327,-5.8288,-5.6292,-4.8967,-5.1186,-5.1582,-5.6208,-4.5261,-2.4225,-3.0984,-2.4560,-4.9858,-4.1285,-3.6138,-3.4539},
		{-6.5900,-8.6854,-8.7293,-7.4175,-7.3120,-7.9339,-6.9621,-7.3332,-9.1041,-8.9355,-7.2193,-6.7040,-8.1889,-8.9374,-9.0792,-8.5440,-7.6863,-8.2024,-8.1414,-7.1456,-6.7608,-7.5717,-8.3675,-9.3472,-8.0739,-6.9942,-7.5944,-5.5882,-6.0580,-4.5552,-5.8512,-6.4996,-5.4398,-3.9167,-3.1853,-3.4936,-3.0059,-3.6473,-2.7873,-4.5926,-5.6678,-7.0073,-7.5730,-7.6383,-7.0412,-6.5418,-7.6386,-8.7058,-7.5799,-7.7749,-7.9071,-7.5871,-7.7027,-9.0817,-9.1809,-6.6291,-7.2733,-5.7055,-6.4173,-7.0058,-7.4976,-6.5915,-7.3416,-5.5181,-7.1888},
		{-2.6699,-0.5220,-0.5477,1.7211,2.0123,2.7150,0.3532,0.6867,0.7198,-0.7951,-1.3286,0.0397,0.1460,-0.8292,1.6544,0.8536,-0.4604,1.2616,1.9088,2.6779,2.8185,0.4113,1.5228,2.3259,1.9848,-0.4991,1.1439,0.0361,2.1047,1.8103,3.4297,2.5608,3.6263,1.7578,1.4607,2.2816,3.0767,1.4184,1.8164,0.0473,-0.1090,0.5478,0.9884,1.1511,2.0132,1.4877,0.8391,1.7165,2.6574,0.4193,-0.3045,-0.1329,-0.3113,3.1116,3.2324,0.6162,1.6840,0.9045,3.5978,2.4163,4.9221,4.1009,3.3824,1.3678,2.6367},
		{-1.7236,0.1041,-0.9015,1.2381,1.3501,0.7766,0.2121,-1.0929,-0.1623,-1.1010,-2.0523,-1.7778,-2.4916,-1.6783,-2.8258,-2.7901,-3.5940,-1.9621,-0.9903,-1.3826,-2.4351,-1.9747,-2.1632,-1.6895,-1.9685,-2.3966,-2.4746,-1.1381,-1.0132,-0.8882,-1.6173,-1.1195,-0.5963,-0.9368,0.5009,-0.3468,-0.4385,-1.4482,-0.6603,0.1531,-0.6691,0.2661,0.8144,0.2138,0.2626,0.5317,-0.4481,-1.2902,-1.9360,-1.5594,-2.4061,-2.2991,-2.2377,-2.5969,-2.7573,-1.4375,-1.7418,-2.3166,-3.2803,-4.2601,-3.1554,-2.0961,-2.8417,-2.6317,-3.0429},
		{-1.8724,-2.3159,-2.3779,-1.9958,-2.0664,-1.4696,-0.7509,-2.2922,-2.3346,-2.4301,-2.8319,-3.0051,-1.9631,-2.5624,-2.1443,-2.7848,-1.9389,-2.8812,-3.0658,-2.6514,-2.0992,-3.1614,-3.4528,-3.7418,-5.4543,-2.9864,-4.8978,-3.2718,-3.8027,-2.6635,-3.2985,-2.6178,-3.2313,-2.9598,-1.8419,-1.8974,-2.5619,-3.4699,-2.4621,-0.8142,-1.1610,-4.2750,-1.4155,-1.2318,-2.4381,-2.2939,-1.9562,-1.6683,-2.7291,-2.8072,-2.8836,-2.8389,-2.0139,-3.1225,-2.3165,-1.2672,-1.8266,-2.5309,-3.9496,-3.9145,-5.1051,-4.3006,-4.2045,-3.7030,-3.4409},
		{0.0664,0.1300,0.0898,-0.0522,-0.0604,1.0851,0.8410,0.5449,1.0387,0.0683,0.3845,-0.6578,-0.2215,0.1288,0.6302,-0.6058,0.3929,-0.4770,-0.8725,-0.5220,0.2583,-0.7844,-0.4483,-0.2091,0.5371,-0.1387,-0.2562,-1.3542,-1.9755,-0.5562,0.4287,-0.5827,0.0335,-0.3394,0.6453,0.5443,0.0608,0.7945,0.5136,0.6888,0.6770,-0.2401,1.0537,1.5927,0.4966,0.4992,0.5625,0.5799,-0.3751,0.7754,1.5091,0.1779,0.1140,0.0411,1.1435,0.6216,0.3625,-0.3283,1.2377,0.7326,0.4292,0.2283,-0.6470,-0.1615,-0.2543},
		{1.8657,3.5051,2.3068,1.8454,1.3681,0.9091,1.5873,1.8689,1.9828,1.7173,2.6486,1.0309,0.1451,-0.4474,-0.7150,-0.4567,0.0000,1.2792,1.1647,0.9528,0.2593,0.6181,1.2424,0.4253,0.9694,1.3563,0.6336,0.7273,-0.3841,-0.4024,0.2389,0.1454,0.6414,0.0599,1.9474,0.6570,0.3890,1.4548,0.6530,0.5777,1.0930,3.6078,2.9176,2.2409,0.8119,1.3540,0.8523,0.7307,-0.1069,1.7591,2.8229,1.1550,0.5098,-1.4482,-0.8081,0.8337,0.0016,-0.1558,0.0556,-0.9114,-0.4375,-0.1266,-0.9289,-0.1583,-1.0460},
		{1.9215,4.0648,1.7018,0.5652,0.0131,0.0621,0.0810,0.7546,2.7449,1.6860,2.3095,1.5408,1.4991,0.9774,0.5866,0.2353,0.4372,2.0733,1.4510,1.0530,0.2859,1.6528,1.2330,0.0621,2.4882,1.3125,1.1165,1.0336,-0.1431,0.0049,0.7572,1.0586,0.3160,0.4363,0.4635,-0.2972,0.1748,-0.1982,-0.4125,0.2429,0.2117,1.4715,1.6837,0.3237,-0.4534,0.1565,-0.2948,0.4625,0.7885,0.5849,1.4142,0.9322,0.4028,0.6117,1.7688,0.3547,0.2636,0.1251,-0.1310,-0.8692,0.0575,-1.1522,0.3060,0.1164,0.1898},
		{1.3212,2.1217,-0.2142,-0.9041,-0.7936,-0.4086,-0.8367,-0.3284,-0.1816,-0.4083,0.9760,1.6349,1.6309,0.8316,1.7534,1.1045,1.7127,1.1598,0.2980,0.7362,1.4929,1.4818,2.2777,1.9905,2.5869,2.0126,1.8552,1.2782,0.4312,0.2926,1.2377,1.1150,0.8939,2.2029,-0.1092,0.7825,0.8919,0.8248,0.2131,1.1985,1.0306,1.9116,0.9327,-0.6238,-0.8310,-0.7449,-0.4122,0.0091,0.0651,-0.3295,0.7649,0.7337,0.7603,1.0964,1.0992,-0.0316,0.4348,0.6532,0.2282,0.0727,0.5188,0.0243,0.3368,0.4238,0.2130},
		{-0.3365,-1.3229,-1.7223,-1.6604,-0.7434,-0.6667,-1.3365,-0.9397,-1.3632,-1.5989,-0.0620,1.3387,1.5835,1.2651,2.3730,2.2558,1.9225,2.1261,1.5794,1.4014,2.7372,3.3481,3.4170,3.2678,2.3134,2.9697,3.1769,2.3611,2.8083,2.4085,1.7725,2.0362,2.3636,1.0329,1.2086,1.3577,1.3893,1.3089,0.6191,1.9113,0.6700,-0.2083,-0.9652,-0.5607,-1.0290,-0.6218,-0.7126,-0.0760,-0.7092,-0.5154,0.4175,1.0105,1.0941,1.4790,0.2617,0.7494,1.2398,1.4066,2.7430,3.3364,2.6926,2.5531,2.0284,2.8445,3.4220},
		{-2.1268,-3.5435,-2.6094,-1.5435,-1.1174,-2.0187,-1.8151,-1.7345,-1.9566,-3.0350,-1.3766,-1.3291,-1.0649,-0.3340,0.0753,0.4848,0.4921,0.6648,0.8478,1.1940,1.0037,1.6913,1.6565,1.0586,0.5877,1.9169,1.1474,1.6143,1.7874,1.3691,-0.3777,0.7129,0.4441,1.0330,1.6069,0.7242,0.6310,-0.1072,-0.5344,1.3241,-2.2146,-4.8042,-3.4190,-2.3209,-1.1078,-0.6540,-1.1775,-1.0219,-0.7785,-2.0291,-1.5205,-1.2657,-0.5378,0.3049,0.2423,-0.4182,0.6292,-0.1402,-0.1732,0.2424,-0.2638,-0.0422,0.2852,0.6140,0.6002},
		{-1.6241,-1.5677,0.1595,0.2006,-0.3337,-0.0334,-0.9288,-0.0505,0.1457,-1.0205,-0.9659,-1.4397,-0.8324,0.4034,0.9101,-0.0659,0.4936,0.9347,0.3145,0.7608,0.3286,0.2506,-0.0352,0.0741,-0.5955,-0.5999,0.3506,-0.6162,-0.4259,-0.0071,0.1771,-0.1709,-0.3333,0.2232,-0.9585,-0.8446,-0.5476,0.6502,0.1630,-0.0187,-2.1805,-2.0375,0.4136,-0.6324,0.2707,-0.5810,-0.5888,0.2601,0.6461,-0.3566,-0.6265,-0.9285,-0.1500,0.1791,0.2659,0.0973,0.6752,0.5056,0.5221,1.0859,0.6168,1.0017,1.1338,0.8283,1.4126},
		{0.1449,0.6686,-0.5159,0.0669,-0.5662,-0.1202,-0.2605,-0.4419,-1.3285,-0.5396,-0.6217,-1.2266,-1.8054,-1.5896,-2.0818,-2.6022,-1.9489,-2.3548,-2.0123,-2.0129,-2.6898,-3.5314,-4.4612,-3.9693,-2.8454,-3.4152,-2.9415,-2.3929,-3.2684,-2.7443,-2.5051,-2.3529,-3.0104,-1.6501,-2.6801,-2.6820,-2.4510,-0.9126,-1.3492,-1.2709,0.0617,1.0659,-0.8774,-0.2569,0.0398,-0.9537,-0.5413,-0.6009,-0.5021,0.1228,0.1309,-0.5733,-1.3301,-2.5012,-1.4061,-0.1977,-1.1944,0.2006,0.1051,0.2711,0.5297,1.1314,-0.6712,-0.7573,-1.0542},
		{0.2989,0.7113,0.3963,-0.3250,-0.3007,0.1786,0.1568,-0.6172,0.1555,0.3724,-0.1888,-0.0923,-0.0264,-0.4603,-1.0752,-1.7280,-2.0408,-1.8693,-1.9546,-1.4222,-2.7251,-1.9878,-1.8815,-1.4081,-0.6103,-1.4081,-1.7211,-0.9363,-1.0063,-1.3811,-1.2432,-0.4063,-1.9190,-0.9011,-0.6390,-0.5203,-0.5105,0.4049,-0.1327,0.2133,0.4766,0.6267,0.3374,0.6837,0.1057,-0.1222,0.0201,0.0508,-0.0940,0.1935,0.4086,0.4747,-0.3156,-1.6399,-0.4077,-0.1327,-1.2704,-0.7025,-0.8040,-0.5753,-0.2802,-0.1245,-1.2748,-1.4340,-0.8047},
		{-0.4731,-0.2177,-0.4496,-0.7585,-0.1818,-0.4104,0.0187,-0.8843,-0.4822,0.0361,-0.6394,-0.5370,0.1132,-0.2028,0.2368,-0.5580,-0.5615,-1.1744,-0.8810,-0.1133,-0.3748,-0.2321,-0.1885,0.2834,1.8471,0.1117,0.6525,0.5235,0.3419,0.2366,1.0221,0.6281,0.3488,0.1637,0.4627,0.4264,0.0927,0.5091,0.3060,0.1648,-0.7395,-0.7265,-0.3535,0.1672,-0.2855,-0.4773,-0.5414,-1.2838,-0.3288,-0.1557,-0.3117,0.0132,-0.3249,-1.0192,-1.0747,-0.5843,-0.5079,-1.3119,-1.1924,-0.3411,-1.0694,-1.5057,-2.0448,-1.5338,-1.2203},
		{-0.3275,0.6543,0.7070,0.6132,1.4335,0.9167,0.4780,0.4055,-0.0092,0.9780,-0.1085,-0.3051,-0.7244,-0.1393,0.0327,0.1954,0.5759,0.0055,0.1905,0.4053,0.3006,0.5460,0.2114,0.5141,-0.4066,-0.2749,0.0716,0.3322,-0.0097,-0.1255,-0.1165,0.3278,-0.0565,1.0724,0.2243,0.2249,0.0138,0.3916,0.3364,0.4254,-0.3170,0.4527,0.2129,0.9780,1.4224,0.5233,0.4133,0.4482,-0.1844,0.8597,0.6054,-0.5125,-0.0537,0.2694,-0.2932,0.6417,0.8156,0.2530,-0.3308,-0.0679,-0.5589,-0.0104,0.3482,-0.0573,-0.0295},
		{-0.2491,-0.5247,-0.0229,-0.1915,0.0181,-0.4120,-0.1622,-0.3060,-0.5927,0.3522,-0.4598,-0.6137,-1.0034,-1.1754,-0.5990,-0.5550,-0.9115,-0.7582,-0.3750,-0.5948,-0.5991,-0.6776,-1.4683,-1.3218,-1.9435,-0.9981,-0.4479,-0.2168,-0.4731,-0.0208,-0.2431,-0.0868,-0.3952,-0.4523,-1.0543,-1.1266,-0.7061,-0.7449,-0.1994,-0.0141,0.1653,-0.4497,0.3700,0.0886,-0.4588,-0.8172,-0.8702,-0.6913,-0.0207,0.2869,-0.0566,-0.9951,-1.0515,0.3113,0.0524,0.0078,-0.1567,0.5981,0.5854,0.6525,0.5905,0.7923,1.0949,0.8121,1.2597},
		{-0.4241,-1.4524,-0.3364,-1.0007,-1.2414,-0.5688,-0.5615,-0.6013,-0.0183,-0.1988,-0.5110,-0.3862,0.0397,-0.4112,-0.0963,-0.1023,-1.1168,-0.5396,-0.9743,-0.5940,-0.6246,-0.2068,0.5187,1.1574,0.5403,0.4544,0.2974,0.0970,0.5969,0.6711,0.0419,0.2042,0.3151,0.1031,-0.3298,-0.2972,0.3729,0.4606,0.1731,0.4148,0.0141,-1.7401,-1.0021,-1.3608,-1.0902,-0.6957,-1.3551,-0.7589,-0.4492,-0.5076,-0.8098,-0.7493,-0.6292,-0.4695,-1.8012,-0.8434,-0.8635,-0.0456,-0.3299,-0.0190,0.8108,0.2288,0.1909,0.1884,-0.1872}

};

//buttons - filter/nofilter
#define TOUCH_RECORD_XMIN       180
#define TOUCH_RECORD_XMAX       210
#define TOUCH_RECORD_YMIN       210
#define TOUCH_RECORD_YMAX       239

#define TOUCH_STOP_XMIN         100
#define TOUCH_STOP_XMAX         125
#define TOUCH_STOP_YMIN         210
#define TOUCH_STOP_YMAX         239

#define TOUCH_PAUSE_XMIN        20
#define TOUCH_PAUSE_XMAX        60
#define TOUCH_PAUSE_YMIN        210
#define TOUCH_PAUSE_YMAX        239

#define TOUCH_CHOOSE1_XMIN 	    20
#define TOUCH_CHOOSE1_XMAX 		125
#define TOUCH_CHOOSE1_YMIN 		100
#define TOUCH_CHOOSE1_YMAX 		239

#define TOUCH_CHOOSE2_XMAX 		230
#define TOUCH_CHOOSE2_XMIN 		125
#define TOUCH_CHOOSE2_YMIN 		100
#define TOUCH_CHOOSE2_YMAX 		239

//Private variables
static float32_t mfcc_section[19][65];//mfcc for section
static const uint16_t base_length = 65;
//Public variables
AUDIO_StateTypeDef AudioState;
AUDIO_IN_BufferTypeDef  BufferCtl;

//FIR Coefficients buffer generated using fir1() MATLAB function.
//fir1(28, 6/24)
/*const float32_t firCoeffs32[NUM_TAPS] = {
  -0.0018225230f, -0.0015879294f, +0.0000000000f, +0.0036977508f, +0.0080754303f, +0.0085302217f, -0.0000000000f, -0.0173976984f,
  -0.0341458607f, -0.0333591565f, +0.0000000000f, +0.0676308395f, +0.1522061835f, +0.2229246956f, +0.2504960933f, +0.2229246956f,
  +0.1522061835f, +0.0676308395f, +0.0000000000f, -0.0333591565f, -0.0341458607f, -0.0173976984f, -0.0000000000f, +0.0085302217f,
  +0.0080754303f, +0.0036977508f, +0.0000000000f, -0.0015879294f, -0.0018225230f
};//*/
/*const float32_t firCoeffs32[NUM_TAPS] = {
		1, -0.9735
};//*/
// Declare State buffer of size (numTaps + blockSize - 1)
//static float32_t firStateF32[BLOCK_SIZE + NUM_TAPS - 1];
//arm_fir_instance_f32 S;

//Private functions
static void AUDIO_REC_DisplayButtons(void);
static void DisplayChoose(void);
static void LCD_ClearZone(void);

AUDIO_ErrorTypeDef AUDIO_REC_Start(void)
{

  //init filter
  //arm_fir_init_f32(&S, NUM_TAPS, (float32_t *)&firCoeffs32[0], &firStateF32[0], BLOCK_SIZE);
  /* Create a new file system */
 // if(f_open(&WavFile, REC_WAVE_NAME, FA_CREATE_ALWAYS | FA_WRITE) == FR_OK)
 // {
    /* Initialize header file */
 //   WavProcess_EncInit(DEFAULT_AUDIO_IN_FREQ, Header_Buffer);
    /* Write header file */
  //  if(f_write(&WavFile, Header_Buffer, 44, (void*)&byteswritten) == FR_OK)
  //  {
	AudioState = AUDIO_STATE_PRERECORD_CHOOSE;
	DisplayChoose();
	BSP_AUDIO_IN_InitEx(INPUT_DEVICE_DIGITAL_MICROPHONE_2, BSP_AUDIO_FREQUENCY_8K, DEFAULT_AUDIO_IN_BIT_RESOLUTION, DEFAULT_AUDIO_IN_CHANNEL_NBR);
	BSP_AUDIO_IN_Record((uint16_t*)&BufferCtl.pcm_buff[0], AUDIO_IN_BUFFER_SIZE);
	BufferCtl.pcm_ptr = 0;
	BufferCtl.offset = 0;
	BufferCtl.wr_state = BUFFER_EMPTY;
	return AUDIO_ERROR_NONE;
}

AUDIO_ErrorTypeDef AUDIO_REC_Process(void)
{
	AUDIO_ErrorTypeDef audio_error = AUDIO_ERROR_NONE;
	static uint32_t t = 0;
	static uint32_t cry_count = 0;
	float32_t accumulated = 0;
	float32_t accumulatedtemp = 0;
	float32_t cepstrumtest[20]={0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
	float32_t dctout[20]={0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
	uint8_t str[20];
	uint8_t x,y;
	static TS_StateTypeDef  TS_State={0};

	switch(AudioState)
	{
	case AUDIO_STATE_PRERECORD_CHOOSE:
		if(TS_State.touchDetected == 1)   /* If previous touch has not been released, we don't proceed any touch command */
		{
			BSP_TS_GetState(&TS_State);
		}
		else
		{
			BSP_TS_GetState(&TS_State);
			x = TouchScreen_Get_Calibrated_X(TS_State.touchX[0]);
			y = TouchScreen_Get_Calibrated_Y(TS_State.touchY[0]);
			if(TS_State.touchDetected == 1)
			{
				if ((x > TOUCH_CHOOSE1_XMIN) && (x < TOUCH_CHOOSE1_XMAX) &&
						(y > TOUCH_CHOOSE1_YMIN) && (y < TOUCH_CHOOSE1_YMAX))
				{
					AudioState = AUDIO_STATE_BEFORE_PRERECORD;
				}
				else if ((x > TOUCH_CHOOSE2_XMIN) && (x < TOUCH_CHOOSE2_XMAX) &&
						(y > TOUCH_CHOOSE2_YMIN) && (y < TOUCH_CHOOSE2_YMAX))
				{
					AudioState = AUDIO_STATE_BEFORE_PRERECORD;
				}
			}
			else
			{
				AudioState = AUDIO_STATE_PRERECORD_CHOOSE;
			}
		}
		break;

	case AUDIO_STATE_BEFORE_PRERECORD:
		LCD_ClearZone();
		AUDIO_REC_DisplayButtons();
		AudioState = AUDIO_STATE_PRERECORD;
		break;

	case AUDIO_STATE_PRERECORD:
		if(TS_State.touchDetected == 1)   /* If previous touch has not been released, we don't proceed any touch command */
		{
			BSP_TS_GetState(&TS_State);
		}
		else
		{
			BSP_TS_GetState(&TS_State);
			x = TouchScreen_Get_Calibrated_X(TS_State.touchX[0]);
			y = TouchScreen_Get_Calibrated_Y(TS_State.touchY[0]);
			if(TS_State.touchDetected == 1)
			{
				if ((x > TOUCH_STOP_XMIN) && (x < TOUCH_STOP_XMAX) &&
						(y > TOUCH_STOP_YMIN) && (y < TOUCH_STOP_YMAX))
				{
					AudioState = AUDIO_STATE_STOP;
				}
				else if ((x > TOUCH_RECORD_XMIN) && (x < TOUCH_RECORD_XMAX) &&
						(y > TOUCH_RECORD_YMIN) && (y < TOUCH_RECORD_YMAX))
				{
					AudioState = AUDIO_STATE_RECORD;
				}
			}
			else
			{
				AudioState = AUDIO_STATE_PRERECORD;
			}
		}
		break;
		break;

	case AUDIO_STATE_RECORD:
		BSP_LCD_SetTextColor(LCD_COLOR_RED);    /* Display red record circle */
		BSP_LCD_FillCircle((TOUCH_RECORD_XMAX+TOUCH_RECORD_XMIN)/2,
							(TOUCH_RECORD_YMAX+TOUCH_RECORD_YMIN)/2,
							(TOUCH_RECORD_XMAX-TOUCH_RECORD_XMIN)/2);
		BSP_LCD_SetFont(&LCD_LOG_TEXT_FONT);
		BSP_LCD_SetTextColor(LCD_COLOR_YELLOW);
		BSP_LCD_DisplayStringAt(15, LINE(6), (uint8_t *)"  [RECORD]", RIGHT_MODE);

		if(TS_State.touchDetected == 1)   /* If previous touch has not been released, we don't proceed any touch command */
		{
			BSP_TS_GetState(&TS_State);
		}
		else
		{
			BSP_TS_GetState(&TS_State);
			x = TouchScreen_Get_Calibrated_X(TS_State.touchX[0]);
			y = TouchScreen_Get_Calibrated_Y(TS_State.touchY[0]);
			if(TS_State.touchDetected == 1)
			{
				if ((x > TOUCH_STOP_XMIN) && (x < TOUCH_STOP_XMAX) &&
						(y > TOUCH_STOP_YMIN) && (y < TOUCH_STOP_YMAX))
				{
					AudioState = AUDIO_STATE_STOP;
				}
				else if ((x > TOUCH_PAUSE_XMIN) && (x < TOUCH_PAUSE_XMAX) &&
						(y > TOUCH_PAUSE_YMIN) && (y < TOUCH_PAUSE_YMAX))
     	  {
					AudioState = AUDIO_STATE_PAUSE;
     	  }
			}
		}

		if(BufferCtl.wr_state == BUFFER_FULL)
		{
			if(t<65){
				mfcc((uint16_t *)(BufferCtl.pcm_buff + BufferCtl.offset),cepstrumtest);
				DCT_custom(cepstrumtest,dctout,20);
				for(uint8_t n = 1; n<20;++n){
					mfcc_section[n-1][t] = cepstrumtest[n];
				}
				++t;
			}
			else
			{
				accumulated = classify(base_length,base,mfcc_section);
				accumulatedtemp = classify(base_length,base2,mfcc_section);
				if(accumulatedtemp<accumulated)
					accumulated = accumulatedtemp;
				accumulatedtemp = classify(base_length,base3,mfcc_section);
				if(accumulatedtemp<accumulated)
					accumulated = accumulatedtemp;
				accumulatedtemp = classify(base_length,base4,mfcc_section);
				if(accumulatedtemp<accumulated)
					accumulated = accumulatedtemp;
				sprintf((char *)str, "%02f", (accumulated));
				BSP_LCD_ClearStringLine(9);
				BSP_LCD_DisplayStringAt(83, LINE(9), str, LEFT_MODE);
				t = 0;
				if(accumulated<THRESHOLD)
				{
					BSP_LCD_ClearStringLine(14);
					BSP_LCD_DisplayStringAtLine(14, (uint8_t *)"CRY");
					cry_count+=3;
					if(cry_count>CRY_THR)
					{
						BSP_LCD_ClearStringLine(7);
						BSP_LCD_DisplayStringAt(0, LINE(7), (uint8_t *)"ALARM", LEFT_MODE);
					}
				}
				else
				{
					BSP_LCD_ClearStringLine(14);
					BSP_LCD_DisplayStringAtLine(14, (uint8_t *)"NO CRY");
					if(cry_count>0)
						cry_count--;
					if(cry_count<CRY_THR/2)
					{
						BSP_LCD_ClearStringLine(7);
					}
				}
			}

    	//if(f_write(&WavFile,(uint8_t*)(BufferCtl.pcm_buff + BufferCtl.offset), //FIXME
      //         AUDIO_IN_BUFFER_SIZE,
      //         (void*)&byteswritten) != FR_OK)
   	//	{
     //  		BSP_LCD_SetTextColor(LCD_COLOR_RED);
     //      	BSP_LCD_DisplayStringAtLine(14, (uint8_t *)"RECORD FAIL");
    //       	return AUDIO_ERROR_IO;
   	//	}
			BufferCtl.wr_state =  BUFFER_EMPTY;
		}

    /* Display elapsed time */
 //   elapsed_time = BufferCtl.fptr / (DEFAULT_AUDIO_IN_FREQ * DEFAULT_AUDIO_IN_CHANNEL_NBR * 2);
//    if(prev_elapsed_time != elapsed_time)
//    {
 //     prev_elapsed_time = elapsed_time;
 //     sprintf((char *)str, "[%02d:%02d]", (int)(elapsed_time /60), (int)(elapsed_time%60));
 //     BSP_LCD_SetTextColor(LCD_COLOR_YELLOW);
 //     BSP_LCD_DisplayStringAt(31, LINE(9), str, RIGHT_MODE);
 //     sprintf((char *)str, "%4d KB", (int)((int32_t)BufferCtl.fptr/1024));
 //     BSP_LCD_DisplayStringAt(83, LINE(9), str, LEFT_MODE);
//    }
		break;

	case AUDIO_STATE_STOP:
    /* Stop recorder */
		cry_count = 0;
		BSP_AUDIO_IN_Stop(CODEC_PDWN_SW);
		BSP_LCD_SetTextColor(LCD_COLOR_CYAN);   /* Display blue cyan record circle */
		BSP_LCD_FillCircle((TOUCH_RECORD_XMAX+TOUCH_RECORD_XMIN)/2,
                       	   (TOUCH_RECORD_YMAX+TOUCH_RECORD_YMIN)/2,
						   (TOUCH_RECORD_XMAX-TOUCH_RECORD_XMIN)/2);
		BSP_LCD_SetTextColor(LCD_COLOR_RED);
		BSP_LCD_FillRect(TOUCH_STOP_XMIN, TOUCH_STOP_YMIN , /* Stop rectangle */
						TOUCH_STOP_XMAX - TOUCH_STOP_XMIN,
						TOUCH_STOP_YMAX - TOUCH_STOP_YMIN);
		BSP_LCD_SetTextColor(LCD_COLOR_CYAN);
//    display_update = 1;
		HAL_Delay(150);
//    if(f_lseek(&WavFile, 0) == FR_OK)
//    {
      /* Update the wav file header save it into wav file */
///      WavProcess_HeaderUpdate(Header_Buffer, &WaveFormat);
//      if(f_write(&WavFile, Header_Buffer, sizeof(WAVE_FormatTypeDef), (void*)&byteswritten) == FR_OK)
//      {
///        audio_error = AUDIO_ERROR_EOF;
//      }
 //     else
 //     {
//        audio_error = AUDIO_ERROR_IO;
//        BSP_LCD_SetTextColor(LCD_COLOR_RED);
//        BSP_LCD_DisplayStringAtLine(14, (uint8_t *)"RECORD FAIL");
//      }
 //   }
//    else
 //   {
//      BSP_LCD_SetTextColor(LCD_COLOR_RED);
//      BSP_LCD_DisplayStringAtLine(14, (uint8_t *)"RECORD FAIL");
//      audio_error = AUDIO_ERROR_IO;
//    }
		audio_error = AUDIO_ERROR_EOF;
		AudioState = AUDIO_STATE_IDLE;
    /* Close file */
//    f_close(&WavFile);
		break;

	case AUDIO_STATE_PAUSE:
		cry_count = 0;
		BSP_LCD_SetTextColor(LCD_COLOR_RED);    /* Displays red pause rectangles */
		BSP_LCD_FillRect(TOUCH_PAUSE_XMIN, TOUCH_PAUSE_YMIN , 15, TOUCH_PAUSE_YMAX - TOUCH_PAUSE_YMIN);
		BSP_LCD_FillRect(TOUCH_PAUSE_XMIN + 20, TOUCH_PAUSE_YMIN, 15, TOUCH_PAUSE_YMAX - TOUCH_PAUSE_YMIN);
		BSP_LCD_SetTextColor(LCD_COLOR_CYAN);   /* Display blue cyan record circle */
		BSP_LCD_FillCircle((TOUCH_RECORD_XMAX+TOUCH_RECORD_XMIN)/2,
						   (TOUCH_RECORD_YMAX+TOUCH_RECORD_YMIN)/2,
					   	   (TOUCH_RECORD_XMAX-TOUCH_RECORD_XMIN)/2);
		BSP_LCD_SetTextColor(LCD_COLOR_YELLOW);
		BSP_LCD_DisplayStringAt(15, LINE(6), (uint8_t *)"  [PAUSE] ", RIGHT_MODE);
		BSP_AUDIO_IN_Pause();
		AudioState = AUDIO_STATE_WAIT;
		break;

	case AUDIO_STATE_RESUME:
		BSP_LCD_SetTextColor(LCD_COLOR_CYAN);    /* Displays blue cyan pause rectangles */
		BSP_LCD_FillRect(TOUCH_PAUSE_XMIN, TOUCH_PAUSE_YMIN , 15, TOUCH_PAUSE_YMAX - TOUCH_PAUSE_YMIN);
		BSP_LCD_FillRect(TOUCH_PAUSE_XMIN + 20, TOUCH_PAUSE_YMIN, 15, TOUCH_PAUSE_YMAX - TOUCH_PAUSE_YMIN);
		BSP_LCD_SetTextColor(LCD_COLOR_RED);    /* Display red record circle */
		BSP_LCD_FillCircle((TOUCH_RECORD_XMAX+TOUCH_RECORD_XMIN)/2,
                           (TOUCH_RECORD_YMAX+TOUCH_RECORD_YMIN)/2,
						   (TOUCH_RECORD_XMAX-TOUCH_RECORD_XMIN)/2);
		BSP_LCD_SetTextColor(LCD_COLOR_YELLOW);
		BSP_LCD_DisplayStringAt(15, LINE(6), (uint8_t *)"  [RECORD]", RIGHT_MODE);
		BSP_AUDIO_IN_Resume();
		AudioState = AUDIO_STATE_RECORD;
		break;

	case AUDIO_STATE_NEXT:
	case AUDIO_STATE_PREVIOUS:
		AudioState = AUDIO_STATE_RECORD;
		break;

	case AUDIO_STATE_WAIT:
		if(TS_State.touchDetected == 1)   /* If previous touch has not been released, we don't proceed any touch command */
		{
			BSP_TS_GetState(&TS_State);
		}
		else
		{
			BSP_TS_GetState(&TS_State);
			x = TouchScreen_Get_Calibrated_X(TS_State.touchX[0]);
			y = TouchScreen_Get_Calibrated_Y(TS_State.touchY[0]);
			if(TS_State.touchDetected == 1)
			{
				if ((x > TOUCH_RECORD_XMIN) && (x < TOUCH_RECORD_XMAX) &&
						(y > TOUCH_RECORD_YMIN) && (y < TOUCH_RECORD_YMAX))
				{
					AudioState = AUDIO_STATE_RESUME;
				}
				else if ((x > TOUCH_PAUSE_XMIN) && (x < TOUCH_PAUSE_XMAX) &&
						(y > TOUCH_PAUSE_YMIN) && (y < TOUCH_PAUSE_YMAX))
				{
					AudioState = AUDIO_STATE_RESUME;
				}
			}
		}
		break;

	case AUDIO_STATE_IDLE:
	case AUDIO_STATE_INIT:
	default:
		/* Do Nothing */
		break;
	}
	return audio_error;
}

void BSP_AUDIO_IN_TransferComplete_CallBack(void)
{
	BufferCtl.pcm_ptr+= AUDIO_IN_BUFFER_SIZE/2;
	if(BufferCtl.pcm_ptr == AUDIO_IN_BUFFER_SIZE/2)
	{
		BufferCtl.wr_state   =  BUFFER_FULL;
		BufferCtl.offset  = 0;
	}
	if(BufferCtl.pcm_ptr >= AUDIO_IN_BUFFER_SIZE)
	{
		BufferCtl.wr_state   =  BUFFER_FULL;
		BufferCtl.offset  = AUDIO_IN_BUFFER_SIZE/2;
		BufferCtl.pcm_ptr = 0;
	}
}

void BSP_AUDIO_IN_HalfTransfer_CallBack(void)
{
	BufferCtl.pcm_ptr+= AUDIO_IN_BUFFER_SIZE/2;
	if(BufferCtl.pcm_ptr == AUDIO_IN_BUFFER_SIZE/2)
	{
		BufferCtl.wr_state   =  BUFFER_FULL;
		BufferCtl.offset  = 0;
	}

	if(BufferCtl.pcm_ptr >= AUDIO_IN_BUFFER_SIZE)
	{
		BufferCtl.wr_state   =  BUFFER_FULL;
		BufferCtl.offset  = AUDIO_IN_BUFFER_SIZE/2;
		BufferCtl.pcm_ptr = 0;
	}
}

//static uint32_t WavProcess_EncInit(uint32_t Freq, uint8_t *pHeader)
//{
  /* Initialize the encoder structure */
//  WaveFormat.SampleRate = Freq;        /* Audio sampling frequency */
 // WaveFormat.NbrChannels = 1;          /* Number of channels: 1:Mono or 2:Stereo */
//  WaveFormat.BitPerSample = 16;        /* Number of bits per sample (16, 24 or 32) */
//  WaveFormat.FileSize = 0x001D4C00;    /* Total length of useful audio data (payload) */
//  WaveFormat.SubChunk1Size = 44;       /* The file header chunk size */
//  WaveFormat.ByteRate = (WaveFormat.SampleRate * \
//                        (WaveFormat.BitPerSample/8) * \
//                         WaveFormat.NbrChannels);     /* Number of bytes per second  (sample rate * block align)  */
 // WaveFormat.BlockAlign = WaveFormat.NbrChannels * \
//                         (WaveFormat.BitPerSample/8); /* channels * bits/sample / 8 */

  /* Parse the wav file header and extract required information */
//  if(WavProcess_HeaderInit(pHeader, &WaveFormat))
///  {
//    return 1;
//  }
//  return 0;
//}

//static uint32_t WavProcess_HeaderInit(uint8_t* pHeader, WAVE_FormatTypeDef* pWaveFormatStruct)
//{
  /* Write chunkID, must be 'RIFF'  ------------------------------------------*/
 // pHeader[0] = 'R';
 // pHeader[1] = 'I';
///  pHeader[2] = 'F';
//  pHeader[3] = 'F';

  /* Write the file length ---------------------------------------------------*/
  /* The sampling time: this value will be written back at the end of the
     recording operation.  Example: 661500 Btyes = 0x000A17FC, byte[7]=0x00, byte[4]=0xFC */
//  pHeader[4] = 0x00;
//  pHeader[5] = 0x4C;
//  pHeader[6] = 0x1D;
//  pHeader[7] = 0x00;
  /* Write the file format, must be 'WAVE' -----------------------------------*/
//  pHeader[8]  = 'W';
//  pHeader[9]  = 'A';
//  pHeader[10] = 'V';
//  pHeader[11] = 'E';

  /* Write the format chunk, must be'fmt ' -----------------------------------*/
//  pHeader[12]  = 'f';
//  pHeader[13]  = 'm';
//  pHeader[14]  = 't';
//  pHeader[15]  = ' ';

  /* Write the length of the 'fmt' data, must be 0x10 ------------------------*/
//  pHeader[16]  = 0x10;
//  pHeader[17]  = 0x00;
//  pHeader[18]  = 0x00;
//  pHeader[19]  = 0x00;

  /* Write the audio format, must be 0x01 (PCM) ------------------------------*/
//  pHeader[20]  = 0x01;
 // pHeader[21]  = 0x00;

  /* Write the number of channels, ie. 0x01 (Mono) ---------------------------*/
 // pHeader[22]  = pWaveFormatStruct->NbrChannels;
 // pHeader[23]  = 0x00;

  /* Write the Sample Rate in Hz ---------------------------------------------*/
  /* Write Little Endian ie. 8000 = 0x00001F40 => byte[24]=0x40, byte[27]=0x00*/
//  pHeader[24]  = (uint8_t)((pWaveFormatStruct->SampleRate & 0xFF));
//  pHeader[25]  = (uint8_t)((pWaveFormatStruct->SampleRate >> 8) & 0xFF);
//  pHeader[26]  = (uint8_t)((pWaveFormatStruct->SampleRate >> 16) & 0xFF);
//  pHeader[27]  = (uint8_t)((pWaveFormatStruct->SampleRate >> 24) & 0xFF);

  /* Write the Byte Rate -----------------------------------------------------*/
//  pHeader[28]  = (uint8_t)((pWaveFormatStruct->ByteRate & 0xFF));
//  pHeader[29]  = (uint8_t)((pWaveFormatStruct->ByteRate >> 8) & 0xFF);
//  pHeader[30]  = (uint8_t)((pWaveFormatStruct->ByteRate >> 16) & 0xFF);
//  pHeader[31]  = (uint8_t)((pWaveFormatStruct->ByteRate >> 24) & 0xFF);

  /* Write the block alignment -----------------------------------------------*/
//  pHeader[32]  = pWaveFormatStruct->BlockAlign;
//  pHeader[33]  = 0x00;

  /* Write the number of bits per sample -------------------------------------*/
//  pHeader[34]  = pWaveFormatStruct->BitPerSample;
//  pHeader[35]  = 0x00;

  /* Write the Data chunk, must be 'data' ------------------------------------*/
//  pHeader[36]  = 'd';
//  pHeader[37]  = 'a';
//  pHeader[38]  = 't';
//  pHeader[39]  = 'a';

  /* Write the number of sample data -----------------------------------------*/
  /* This variable will be written back at the end of the recording operation */
//  pHeader[40]  = 0x00;
//  pHeader[41]  = 0x4C;
//  pHeader[42]  = 0x1D;
//  pHeader[43]  = 0x00;

  /* Return 0 if all operations are OK */
//  return 0;
//}

//static uint32_t WavProcess_HeaderUpdate(uint8_t* pHeader, WAVE_FormatTypeDef* pWaveFormatStruct)
//{
  /* Write the file length ---------------------------------------------------*/
  /* The sampling time: this value will be written back at the end of the
     recording operation.  Example: 661500 Btyes = 0x000A17FC, byte[7]=0x00, byte[4]=0xFC */
///  pHeader[4] = (uint8_t)(BufferCtl.fptr);
//  pHeader[5] = (uint8_t)(BufferCtl.fptr >> 8);
//  pHeader[6] = (uint8_t)(BufferCtl.fptr >> 16);
//  pHeader[7] = (uint8_t)(BufferCtl.fptr >> 24);
  /* Write the number of sample data -----------------------------------------*/
  /* This variable will be written back at the end of the recording operation */
//  BufferCtl.fptr -=44;
///  pHeader[40] = (uint8_t)(BufferCtl.fptr);
//  pHeader[41] = (uint8_t)(BufferCtl.fptr >> 8);
//  pHeader[42] = (uint8_t)(BufferCtl.fptr >> 16);
 // pHeader[43] = (uint8_t)(BufferCtl.fptr >> 24);

  /* Return 0 if all operations are OK */
//  return 0;
//}

static void AUDIO_REC_DisplayButtons(void)
{
	BSP_LCD_SetFont(&LCD_LOG_HEADER_FONT);
	BSP_LCD_ClearStringLine(12);            /* Clear dedicated zone */
	BSP_LCD_ClearStringLine(13);
	BSP_LCD_ClearStringLine(14);
	BSP_LCD_ClearStringLine(15);

	BSP_LCD_SetTextColor(LCD_COLOR_CYAN);
	BSP_LCD_FillCircle((TOUCH_RECORD_XMAX+TOUCH_RECORD_XMIN)/2, /* Record circle */
                       (TOUCH_RECORD_YMAX+TOUCH_RECORD_YMIN)/2,
					   (TOUCH_RECORD_XMAX-TOUCH_RECORD_XMIN)/2);
	BSP_LCD_FillRect(TOUCH_PAUSE_XMIN, TOUCH_PAUSE_YMIN , 15, TOUCH_PAUSE_YMAX - TOUCH_PAUSE_YMIN);    /* Pause rectangles */
	BSP_LCD_FillRect(TOUCH_PAUSE_XMIN + 20, TOUCH_PAUSE_YMIN, 15, TOUCH_PAUSE_YMAX - TOUCH_PAUSE_YMIN);
	BSP_LCD_FillRect(TOUCH_STOP_XMIN, TOUCH_STOP_YMIN , /* Stop rectangle */
                     TOUCH_STOP_XMAX - TOUCH_STOP_XMIN,
                     TOUCH_STOP_YMAX - TOUCH_STOP_YMIN);
	BSP_LCD_SetTextColor(LCD_COLOR_GREEN);
	BSP_LCD_SetFont(&LCD_LOG_TEXT_FONT);
	BSP_LCD_DisplayStringAtLine(14, (uint8_t *)"Use record button to start record,");
	BSP_LCD_DisplayStringAtLine(15, (uint8_t *)"stop to exit");
	BSP_LCD_SetTextColor(LCD_COLOR_CYAN);
}

static void DisplayChoose(void)
{

	LCD_ClearZone();
	BSP_LCD_SetFont(&LCD_LOG_HEADER_FONT);
	BSP_LCD_ClearStringLine(12);            /* Clear dedicated zone */
	BSP_LCD_ClearStringLine(13);
	BSP_LCD_ClearStringLine(14);
	BSP_LCD_ClearStringLine(15);

	BSP_LCD_SetTextColor(LCD_COLOR_CYAN);
	BSP_LCD_FillRect(TOUCH_CHOOSE1_XMIN, TOUCH_CHOOSE1_YMIN , /* Stop rectangle */
			         TOUCH_CHOOSE1_XMAX - TOUCH_CHOOSE1_XMIN,
			         TOUCH_CHOOSE1_YMAX - TOUCH_CHOOSE1_YMIN);

	  //BSP_LCD_SetTextColor(LCD_COLOR_BLACK);
	BSP_LCD_FillRect(TOUCH_CHOOSE2_XMIN, TOUCH_CHOOSE2_YMIN , /* Stop rectangle */
		        	 TOUCH_CHOOSE2_XMAX - TOUCH_CHOOSE2_XMIN,
					 TOUCH_CHOOSE2_YMAX - TOUCH_CHOOSE2_YMIN);

	BSP_LCD_SetTextColor(LCD_COLOR_GREEN);
	BSP_LCD_SetFont(&LCD_LOG_TEXT_FONT);
	BSP_LCD_DisplayStringAt(0,80,(uint8_t *)"START", CENTER_MODE);
	// BSP_LCD_DisplayStringAt(0,80,(uint8_t *)"NO FILTER", RIGHT_MODE);
	BSP_LCD_SetTextColor(LCD_COLOR_CYAN);
}


static void LCD_ClearZone(void)
{

	uint8_t i = 0;

	for(i= 0; i < 13; i++)
	{
		BSP_LCD_ClearStringLine(i + 3);
	}
}



